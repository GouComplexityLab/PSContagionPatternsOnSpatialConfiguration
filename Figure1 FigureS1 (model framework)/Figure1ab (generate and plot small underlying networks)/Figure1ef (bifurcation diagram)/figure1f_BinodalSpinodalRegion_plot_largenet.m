clear all
close all

clc
%% final 2

netname = 'Netpowerlaw12L500';

pre_figname = netname;


beta = 0.05; nu = 2; gamma = 1/3; % illustration

data_name = ['./' netname 'RegionDataSmall_beta=' dot2d(beta) '_nu=' dot2d(nu) '.mat'];
eval(['load ' data_name])


%%
fig = figure;
set(gcf,'Position', [100 300 500 420])
axes('Position',[0.13 0.15 0.747 0.775000000000001]);
set(gca,'Color','none')

gwLineWidth = 1.5;

left_color = [0 0 1];
right_color = [0 0 0];
set(fig,'defaultAxesColorOrder',[left_color; right_color]);

% yyaxis left
hold on
x1 = N_values(find(isnan(critical_d_s_min1_values1)==0)); 
y1 = critical_d_s_min1_values1(find(isnan(critical_d_s_min1_values1)==0));
x2 = N_values(find(isnan(critical_d_s_max1_values1)==0));
y2 = critical_d_s_max1_values1(find(isnan(critical_d_s_max1_values1)==0));

left_mostmin_N = min(x1);
left_mostmin_ds = min(y1);
left_mostmax_N = min(x2);
left_mostmax_ds = min(y2);

x_fill = [x1, fliplr(x2)];
y_fill = [y1, fliplr(y2)];
f1 = fill(x_fill, y_fill,'b', 'FaceAlpha', 0.3,'EdgeColor', 'b','LineWidth',gwLineWidth,'LineStyle','-');
%%
tau_cha = tau_zheng_save - tau_0_save;
postion = find(tau_cha>1e-3);
postion = [postion(1)-1,postion];
tau_0_save = tau_0_save(postion);
tau_zheng_save = tau_zheng_save(postion);
d_ss = d_ss(postion);

plot(tau_0_save, d_ss,'r-','LineWidth',gwLineWidth)
plot(tau_zheng_save, d_ss,'b-','LineWidth',gwLineWidth)

x_fill = [tau_0_save, fliplr(tau_zheng_save)];
y_fill = [d_ss,fliplr(d_ss)];

f2 = fill(x_fill, y_fill, 'r', 'FaceAlpha', 0.3,'EdgeColor', 'b','LineWidth',gwLineWidth,'LineStyle','-');  % 'c'表示填充颜色为青色，'FaceAlpha'控制填充的透明度\

N_max = 14;
N_1 = 2*sqrt(gamma/beta/nu)-1/nu;
N_2 = gamma/beta;

ax = gca;
ax.XTick = [0, N_1, N_2]; 
ax.XTickLabel = {'0','$N^{sub}_{c}$', '$N_{c}$'};  
ax.XAxis.FontName = 'Times New Roman'; 
ax.TickLabelInterpreter = 'latex';

ax.YTick = [1]; 
ax.YTickLabel = {'1'}; 
ax.YAxis.FontName = 'Times New Roman';
ax.TickLabelInterpreter = 'latex';

box on
xlim([0 N_max])
ylim([1 30])
set(gca,'XColor','k','YColor','k','TickLength',...
    [0.03 0.15],'FontSize',24,'linewidth',gwLineWidth,'layer','top');

annotation('textbox',...
    [0.288062500000001 0.659523809523811 0.311937499999999 0.185527103923343],...
    'String',{'spinodal region'},...
    'Rotation',0,...
    'LineStyle','none',...
    'Interpreter','latex',...
    'HorizontalAlignment','center',...
    'FontSize',24,...
    'FontName','Times New Roman',...
    'FitBoxToText','off');
annotation('textbox',...
    [0.563 0.423809523809531 0.431000000000001 0.0904761904761959],...
    'String',{'binodal region'},...
    'Rotation',60,...
    'LineStyle','none',...
    'Interpreter','latex',...
    'HorizontalAlignment','center',...
    'FontSize',24,...
    'FontName','Times New Roman',...
    'FitBoxToText','off');

annotation('arrow',[0.771 0.869],...
    [0.12 0.12],'LineWidth',2,'HeadWidth',12,...
    'HeadLength',12);
annotation('textbox',...
    [0.761 0.0035714285714286 0.089 0.113095238095238],...
    'Color','k',...
    'String',{'$\langle N\rangle$'},...
    'FontName','Times New Roman',...
    'Interpreter','latex',...
    'FontSize',22,...
    'FitBoxToText','off',...
    'EdgeColor','none',...
    'BackgroundColor','none');

annotation('arrow',[0.105 0.105],...
    [0.826190476190476 0.927380952380952],'LineWidth',2,'HeadWidth',12,...
    'HeadLength',12);
annotation('textbox',...
    [0.001 0.817857142857149 0.0639999999999972 0.12519047619048],...
    'Color','k',...
    'String',{'$d_{S}$'},...
    'FontName','Times New Roman',...
    'Interpreter','latex',...
    'FontSize',28,...
    'FitBoxToText','off',...
    'EdgeColor','none',...
    'BackgroundColor','none');

figure_name = ['./fig1f ' pre_figname 'TuringBinodalRegion ' 'beta=' num2str(beta,'%.3f') ' nu=' num2str(nu,'%.3f')  '.eps'];
saveas(gcf, figure_name, 'epsc');

